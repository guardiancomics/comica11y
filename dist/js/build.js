comicStrip=document.querySelector(".comic-strip"),comicFrame=document.querySelectorAll(".comic-frame"),highContrastBtn=document.querySelector(".js-highcontrast"),rtlBtn=document.querySelector(".js-rtl"),ccBtn=document.querySelector(".js-closedcaptions"),bubbleBtn=document.querySelector(".js-bubbles"),window.a11yTabs=function(t,e){"use strict";const i=new WeakMap,n=function(t,e){if(!t||!t.nodeType)throw new Error("The DOM element was not found when creating the tab component");this.options=Object.assign({tabList:".tab-list",tabItem:".tab-item",tabLink:".tab-link",tabPanel:".tab-panel"},e),this.element=t,this.tabList=t.querySelector(this.options.tabList),this.tabItems=[].slice.call(this.tabList.querySelectorAll(this.options.tabItem)),this.tabLinks=[].slice.call(this.tabList.querySelectorAll(this.options.tabLink)),this.tabPanels=[].slice.call(t.querySelectorAll(this.options.tabPanel)),this.currentIndex=0,this.tabList.setAttribute("role","tablist"),this.tabItems.forEach((t,e)=>{t.setAttribute("role","presentation"),0===e&&t.setAttribute("data-tab-active","")}),this.tabLinks.forEach((t,e)=>{t.setAttribute("role","tab"),t.setAttribute("id","tab"+e),e>0?t.setAttribute("tabindex","-1"):t.setAttribute("aria-selected","true")}),this.tabPanels.forEach((t,e)=>{t.setAttribute("role","tabpanel"),t.setAttribute("aria-labelledby","tab"+e),t.setAttribute("tabindex","-1"),e>0&&t.setAttribute("hidden","")}),this.eventCallback=o.bind(this),this.tabList.addEventListener("click",this.eventCallback,!1),this.tabList.addEventListener("keydown",this.eventCallback,!1),i.set(this.element,this)};function o(t){if("click"===t.type&&(t.preventDefault(),n.prototype.handleTabInteraction.call(this,this.tabLinks.indexOf(t.target))),"keydown"===t.type){const e=this.tabLinks.indexOf(t.target);37!==t.which&&39!==t.which||(t.preventDefault(),n.prototype.handleTabInteraction.call(this,e,t.which)),40===t.which&&(t.preventDefault(),n.prototype.handleTabpanelFocus.call(this,e))}}return n.prototype={handleTabInteraction:function(t,e){const i=this.currentIndex;let n=t;return e&&(n=37===e?t-1:t+1),n<0?n=this.tabLinks.length-1:n===this.tabLinks.length&&(n=0),this.tabLinks[i].setAttribute("tabindex","-1"),this.tabLinks[i].removeAttribute("aria-selected"),this.tabItems[i].removeAttribute("data-tab-active"),this.tabLinks[n].setAttribute("aria-selected","true"),this.tabItems[n].setAttribute("data-tab-active",""),this.tabLinks[n].removeAttribute("tabindex"),this.tabLinks[n].focus(),this.tabPanels[i].setAttribute("hidden",""),this.tabPanels[n].removeAttribute("hidden"),this.currentIndex=n,this},handleTabpanelFocus:function(t){return this.tabPanels[t].focus(),this}},{create:function(t,o){const r=e.querySelector(t);return i.get(r)||new n(r,o)},destroy:function(t){if(!t||!t.nodeType)throw new Error("The DOM element was not found when deleting the tab component");let e=i.get(t);e.tabList.removeAttribute("role","tablist"),e.tabItems.forEach((t,e)=>{t.removeAttribute("role","presentation"),0===e&&t.removeAttribute("data-tab-active")}),e.tabLinks.forEach((t,e)=>{t.removeAttribute("role","tab"),t.removeAttribute("id","tab"+e),e>0?t.removeAttribute("tabindex","-1"):t.removeAttribute("aria-selected","true")}),e.tabPanels.forEach((t,e)=>{t.removeAttribute("role","tabpanel"),t.removeAttribute("aria-labelledby","tab"+e),t.removeAttribute("tabindex","-1"),e>0&&t.removeAttribute("hidden")}),e.tabList.removeEventListener("click",e.eventCallback),e.tabList.removeEventListener("keydown",e.eventCallback),i.delete(e.element)}}}(window,document);const tabComponent=a11yTabs.create("[data-tab-component]");function colourblindReset(){(comicStrip.classList.contains("is-cb-protanopia")||comicStrip.classList.contains("is-cb-protanomaly")||comicStrip.classList.contains("is-cb-deuteranopia")||comicStrip.classList.contains("is-cb-deuteranomaly")||comicStrip.classList.contains("is-cb-tritanopia")||comicStrip.classList.contains("is-cb-tritanomaly")||comicStrip.classList.contains("is-cb-achromatopsia")||comicStrip.classList.contains("is-cb-achromatomaly"))&&comicStrip.classList.remove("is-cb-protanopia","is-cb-protanomaly","is-cb-deuteranopia","is-cb-deuteranomaly","is-cb-tritanopia","is-cb-tritanomaly","is-cb-achromatopsia","is-cb-achromatomaly")}function bubbles(){comicStrip.classList.add("is-loading"),bubblesResize(),browserZoom(),document.querySelectorAll(".bubble svg").forEach(function(t){t.remove()}),document.querySelectorAll(".bubble").forEach(function(t){xmlns="http://www.w3.org/2000/svg",b_stroke=4,b_handle_length=8,b_width=t.clientWidth,b_height=t.clientHeight,t_direction=t.dataset.direction,"short"==t.dataset.length?t_length=50:"normal"==t.dataset.length?t_length=100:"long"==t.dataset.length?t_length=200:t_length=t.dataset.length,b_1_node_x=b_stroke/2,b_1_node_y=b_height/2,b_1_handle_in_x=b_1_node_x,b_1_handle_in_y=b_height/b_handle_length*(b_handle_length-1),b_1_handle_out_x=b_1_node_x,b_1_handle_out_y=b_height/b_handle_length,b_2_node_x=b_width/2,b_2_node_y=b_stroke/2,b_2_handle_in_x=b_width/b_handle_length,b_2_handle_in_y=b_2_node_y,b_2_handle_out_x=b_width/b_handle_length*(b_handle_length-1),b_2_handle_out_y=b_2_node_y,b_3_node_x=b_width-b_stroke/2,b_3_node_y=b_1_node_y,b_3_handle_in_x=b_3_node_x,b_3_handle_in_y=b_1_handle_out_y,b_3_handle_out_x=b_3_node_x,b_3_handle_out_y=b_1_handle_in_y,b_4_node_x=b_2_node_x,b_4_node_y=b_height-b_stroke/2,b_4_handle_in_x=b_2_handle_out_x,b_4_handle_in_y=b_4_node_y,b_4_handle_out_x=b_2_handle_in_x,b_4_handle_out_y=b_4_node_y,b_path="M"+b_1_node_x+","+b_1_node_y+" ",b_path+="C"+b_1_handle_out_x+","+b_1_handle_out_y,b_path+=" "+b_2_handle_in_x+","+b_2_handle_in_y,b_path+=" "+b_2_node_x+","+b_2_node_y,b_path+="S"+b_3_handle_in_x+","+b_3_handle_in_y,b_path+=" "+b_3_node_x+","+b_3_node_y+" ",b_path+="S"+b_4_handle_in_x+","+b_4_handle_in_y,b_path+=" "+b_4_node_x+","+b_4_node_y,b_path+="S"+b_1_handle_in_x+","+b_1_handle_in_y,b_path+=" "+b_1_node_x+","+b_1_node_y,b_path+=" z","left"==t.dataset.position&&(bezier_point_0={x:b_4_node_x-b_stroke/2,y:b_4_node_y-b_stroke/2},bezier_control_out={x:b_4_handle_out_x-b_stroke/2,y:b_4_handle_out_y-b_stroke/2},bezier_control_in={x:b_1_handle_in_x-b_stroke/2,y:b_1_handle_in_y-b_stroke/2},bezier_point_1={x:b_1_node_x-b_stroke/2,y:b_1_node_y-b_stroke/2},bezier_node_1=Bezier(bezier_point_0,bezier_control_out,bezier_control_in,bezier_point_1,".45"),bezier_node_2=Bezier(bezier_point_0,bezier_control_out,bezier_control_in,bezier_point_1,".2")),"right"==t.dataset.position&&(bezier_point_0={x:b_4_node_x-b_stroke/2,y:b_4_node_y-b_stroke/2},bezier_control_in={x:b_4_handle_in_x-b_stroke/2,y:b_4_handle_in_y-b_stroke/2},bezier_control_out={x:b_3_handle_out_x-b_stroke/2,y:b_3_handle_out_y-b_stroke/2},bezier_point_1={x:b_3_node_x-b_stroke/2,y:b_3_node_y-b_stroke/2},bezier_node_1=Bezier(bezier_point_0,bezier_control_in,bezier_control_out,bezier_point_1,".2"),bezier_node_2=Bezier(bezier_point_0,bezier_control_in,bezier_control_out,bezier_point_1,".45")),t_girth=(bezier_node_2.x-bezier_node_1.x)/4,"center"==t.dataset.position&&(t_girth=10,bezier_node_2={x:b_width/2+2*t_girth-b_stroke/2,y:b_height-b_stroke/2-b_stroke/2},bezier_point_0={x:b_width/2-2*t_girth-b_stroke/2,y:b_height-b_stroke/2-b_stroke/2},bezier_control_out={x:b_4_handle_out_x-b_stroke/2-b_stroke/2,y:b_4_handle_out_y-b_stroke/2-b_stroke/2},bezier_control_in={x:b_1_handle_in_x-b_stroke/2-b_stroke/2,y:b_1_handle_in_y-b_stroke/2-b_stroke/2},bezier_point_1={x:b_width/2+2*t_girth-b_stroke/2,y:b_height-b_stroke/2-b_stroke/2},bezier_node_1=Bezier(bezier_point_0,bezier_control_out,bezier_control_in,bezier_point_1,"1"),bezier_node_2=Bezier(bezier_point_0,bezier_control_out,bezier_control_in,bezier_point_1,"0"),t_girth=(bezier_node_2.x-bezier_node_1.x)/2),"left"==t_direction&&(t_x0=bezier_node_2.x,t_y0=bezier_node_2.y,t_x1=bezier_node_1.x,t_y1=bezier_node_1.y,t_x2=bezier_node_2.x,t_y2=bezier_node_2.y+t_length/10,t_x3=bezier_node_2.x-t_girth,t_y3=bezier_node_2.y+t_length,t_x4=bezier_node_2.x,t_y4=bezier_node_2.y),"right"==t_direction&&(t_x0=bezier_node_1.x,t_y0=bezier_node_1.y,t_x1=bezier_node_2.x,t_y1=bezier_node_2.y,t_x2=bezier_node_1.x,t_y2=bezier_node_1.y+t_length/10,t_x3=bezier_node_1.x+t_girth,t_y3=bezier_node_1.y+t_length,t_x4=bezier_node_1.x,t_y4=bezier_node_1.y),t_path="M"+t_x0+","+(t_y0-1),t_path+="L"+t_x1+","+(t_y1-1),t_path+="Q"+t_x2+","+t_y2,t_path+=" "+t_x3+","+t_y3,t_path+="L"+t_x4+","+(t_y4-1),t_path+="z",b_svg=document.createElementNS(xmlns,"svg"),b_svg_path=document.createElementNS(xmlns,"path"),t_svg_path1=document.createElementNS(xmlns,"path"),t_svg_path2=document.createElementNS(xmlns,"path"),b_svg.setAttribute("viewBox","0 0 "+b_width+" "+(b_height+t_length)),b_svg.setAttribute("width",b_width),b_svg.setAttribute("height",b_height+t_length),b_svg_path.setAttribute("d",b_path),b_svg_path.setAttribute("stroke","#000"),b_svg_path.setAttribute("stroke-width",b_stroke),b_svg_path.setAttribute("stroke-linecap","round"),b_svg_path.setAttribute("stroke-linejoin","round"),b_svg_path.setAttribute("fill","#fff"),t_svg_path1.setAttribute("d",t_path),t_svg_path1.setAttribute("stroke","#000"),t_svg_path1.setAttribute("stroke-width",2*b_stroke),t_svg_path1.setAttribute("stroke-linecap","round"),t_svg_path1.setAttribute("stroke-linejoin","round"),t_svg_path1.setAttribute("fill","#000"),t_svg_path2.setAttribute("d",t_path),t_svg_path2.setAttribute("fill","#fff"),b_svg.appendChild(t_svg_path1),b_svg.appendChild(b_svg_path),b_svg.appendChild(t_svg_path2),t.appendChild(b_svg)}),comicStrip.classList.remove("is-loading"),bubblesResize()}var timeout;function bubblesResize(){w=document.querySelector(".comic-frame").offsetWidth/265+"em",bubbleSel=document.querySelectorAll(".bubble"),bubbleSel.forEach(function(t){t.setAttribute("style","font-size: "+w)})}function browserZoom(){let t=document.querySelector(".bubble"),e=window.getComputedStyle(t);parseInt(e.getPropertyValue("font-size"),10)>23&&(comicStrip.classList.add("is-closed-caption-mode","is-browserZoom"),ccBtn.classList.add("is-active"),ccBtn.setAttribute("aria-pressed",!0))}function Bezier(t,e,i,n,o){var r={x:0,y:0},_=1-o,s=_*_,a=s*_;return r.x=t.x*a+3*e.x*s*o+3*i.x*_*o*o+n.x*o*o*o,r.y=t.y*a+3*e.y*s*o+3*i.y*_*o*o+n.y*o*o*o,r}window.addEventListener("resize",function(t){timeout&&window.cancelAnimationFrame(timeout),timeout=window.requestAnimationFrame(function(){bubbles()})},!1),document.querySelectorAll(".caption-sr").forEach(function(t){t.addEventListener("focus",t=>{t.target.parentNode.classList.add("is-active")}),t.addEventListener("blur",t=>{t.target.parentNode.classList.remove("is-active")})}),document.querySelectorAll(".comic-frame").forEach(function(t){t.addEventListener("click",function(e){t.lastElementChild.focus()})}),highContrastBtn.addEventListener("click",function(t){highContrastBtn.classList.contains("is-active")?(highContrastBtn.classList.remove("is-active"),highContrastBtn.setAttribute("aria-pressed","false"),comicStrip.classList.remove("is-high-contrast-mode"),comicImg=document.querySelectorAll(".comic-image img"),comicImg.forEach(function(t){srcUrl=t.dataset.src,t.setAttribute("src",srcUrl)})):(highContrastBtn.classList.add("is-active"),highContrastBtn.setAttribute("aria-pressed","true"),comicStrip.classList.add("is-high-contrast-mode"),comicImg=document.querySelectorAll(".comic-image img"),comicImg.forEach(function(t){contrastUrl=t.dataset.contrast,t.setAttribute("src",contrastUrl)})),t.preventDefault}),rtlBtn.addEventListener("click",function(){rtlBtn.classList.contains("is-active")?(rtlBtn.classList.remove("is-active"),rtlBtn.setAttribute("aria-pressed","false"),comicStrip.classList.remove("is-rtl-mode")):(rtlBtn.classList.add("is-active"),rtlBtn.setAttribute("aria-pressed","true"),comicStrip.classList.add("is-rtl-mode"))}),ccBtn.addEventListener("click",function(){ccBtn.classList.contains("is-active")?(ccBtn.classList.remove("is-active"),ccBtn.setAttribute("aria-pressed","false"),comicStrip.classList.remove("is-closed-caption-mode"),document.querySelector(".comic-strip").dataset.fontsize="100",document.querySelector(".font-sizer .label strong").innerHTML="100%",document.querySelectorAll(".comic-strip .caption-closed").forEach(function(t){t.style.fontSize="100%"}),document.querySelector(".js-closedcaptions").focus(),document.querySelector(".js-resize-up").disabled=!1,document.querySelector(".js-resize-down").disabled=!0):(ccBtn.classList.add("is-active"),ccBtn.setAttribute("aria-pressed","true"),comicStrip.classList.add("is-closed-caption-mode"),document.querySelector(".comic-strip").firstElementChild.lastElementChild.focus())}),document.querySelectorAll(".font-sizer .btn").forEach(function(t){t.addEventListener("click",function(e){currentSize=document.querySelector(".comic-strip").dataset.fontsize,t.classList.contains("js-resize-up")&&(currentSize=parseFloat(currentSize)+10),t.classList.contains("js-resize-down")&&(currentSize=parseFloat(currentSize)-10),100!=currentSize&&200!=currentSize&&(document.querySelector(".js-resize-down").disabled=!1,document.querySelector(".js-resize-up").disabled=!1),100!=currentSize?(comicStrip.classList.add("is-closed-caption-mode","is-resized"),ccBtn.classList.add("is-active"),ccBtn.setAttribute("aria-pressed","true"),document.querySelector(".comic-strip").firstElementChild.lastElementChild.focus()):(comicStrip.classList.contains("is-browserZoom")||(comicStrip.classList.remove("is-closed-caption-mode"),ccBtn.classList.remove("is-active"),ccBtn.setAttribute("aria-pressed","false")),comicStrip.classList.remove("is-resized")),100==currentSize&&(document.querySelector(".js-resize-down").disabled=!0),200==currentSize&&(document.querySelector(".js-resize-up").disabled=!0),comicStrip.dataset.fontsize=currentSize,document.querySelector(".font-sizer .label strong").innerHTML=currentSize+"%",document.querySelectorAll(".comic-strip .caption-closed").forEach(function(t){t.style.fontSize=currentSize+"%"}),e.preventDefault})}),document.querySelector(".js-colourblind").addEventListener("change",function(t){sel=t.srcElement,opt=sel.options[sel.selectedIndex],mode=opt.value,colourblindReset(),"normal"!=mode?document.querySelector(".comic-strip").classList.add("is-cb-"+mode):colourblindReset()}),bubbles(),bubbleBtn.addEventListener("click",function(t){bubbles(),t.preventDefault});