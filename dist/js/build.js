var timeout;function colourblindReset(){(comicStrip.classList.contains("is-cb-protanopia")||comicStrip.classList.contains("is-cb-protanomaly")||comicStrip.classList.contains("is-cb-deuteranopia")||comicStrip.classList.contains("is-cb-deuteranomaly")||comicStrip.classList.contains("is-cb-tritanopia")||comicStrip.classList.contains("is-cb-tritanomaly")||comicStrip.classList.contains("is-cb-achromatopsia")||comicStrip.classList.contains("is-cb-achromatomaly"))&&comicStrip.classList.remove("is-cb-protanopia","is-cb-protanomaly","is-cb-deuteranopia","is-cb-deuteranomaly","is-cb-tritanopia","is-cb-tritanomaly","is-cb-achromatopsia","is-cb-achromatomaly")}function bubblesResize(){}function bubbleBrowserZoom(){let e=document.querySelector(".bubble"),t=window.getComputedStyle(e);parseInt(t.getPropertyValue("font-size"),10)>23&&(comicStrip.classList.add("is-closed-caption-mode","is-browserZoom"),ccBtn.classList.add("is-active"),ccBtn.setAttribute("aria-pressed",!0))}function bubbles(){comicStrip.classList.add("is-loading"),document.querySelectorAll(".bubble svg").forEach(function(e){e.remove()}),document.querySelectorAll(".bubble").forEach(function(e){xmlns="http://www.w3.org/2000/svg",b_stroke=4,b_handle_length=8,b_width=e.clientWidth,b_height=e.clientHeight,t_direction=e.dataset.direction,"short"==e.dataset.length?t_length=50:"normal"==e.dataset.length?t_length=100:"long"==e.dataset.length?t_length=200:t_length=e.dataset.length,b_1_node_x=b_stroke/2,b_1_node_y=b_height/2,b_1_handle_in_x=b_1_node_x,b_1_handle_in_y=b_height/b_handle_length*(b_handle_length-1),b_1_handle_out_x=b_1_node_x,b_1_handle_out_y=b_height/b_handle_length,b_2_node_x=b_width/2,b_2_node_y=b_stroke/2,b_2_handle_in_x=b_width/b_handle_length,b_2_handle_in_y=b_2_node_y,b_2_handle_out_x=b_width/b_handle_length*(b_handle_length-1),b_2_handle_out_y=b_2_node_y,b_3_node_x=b_width-b_stroke/2,b_3_node_y=b_1_node_y,b_3_handle_in_x=b_3_node_x,b_3_handle_in_y=b_1_handle_out_y,b_3_handle_out_x=b_3_node_x,b_3_handle_out_y=b_1_handle_in_y,b_4_node_x=b_2_node_x,b_4_node_y=b_height-b_stroke/2,b_4_handle_in_x=b_2_handle_out_x,b_4_handle_in_y=b_4_node_y,b_4_handle_out_x=b_2_handle_in_x,b_4_handle_out_y=b_4_node_y,b_path="M"+b_1_node_x+","+b_1_node_y+" ",b_path+="C"+b_1_handle_out_x+","+b_1_handle_out_y,b_path+=" "+b_2_handle_in_x+","+b_2_handle_in_y,b_path+=" "+b_2_node_x+","+b_2_node_y,b_path+="S"+b_3_handle_in_x+","+b_3_handle_in_y,b_path+=" "+b_3_node_x+","+b_3_node_y+" ",b_path+="S"+b_4_handle_in_x+","+b_4_handle_in_y,b_path+=" "+b_4_node_x+","+b_4_node_y,b_path+="S"+b_1_handle_in_x+","+b_1_handle_in_y,b_path+=" "+b_1_node_x+","+b_1_node_y,b_path+=" z","left"==e.dataset.position&&(bezier_point_0={x:b_4_node_x-b_stroke/2,y:b_4_node_y-b_stroke/2},bezier_control_out={x:b_4_handle_out_x-b_stroke/2,y:b_4_handle_out_y-b_stroke/2},bezier_control_in={x:b_1_handle_in_x-b_stroke/2,y:b_1_handle_in_y-b_stroke/2},bezier_point_1={x:b_1_node_x-b_stroke/2,y:b_1_node_y-b_stroke/2},bezier_node_1=Bezier(bezier_point_0,bezier_control_out,bezier_control_in,bezier_point_1,".45"),bezier_node_2=Bezier(bezier_point_0,bezier_control_out,bezier_control_in,bezier_point_1,".2")),"right"==e.dataset.position&&(bezier_point_0={x:b_4_node_x-b_stroke/2,y:b_4_node_y-b_stroke/2},bezier_control_in={x:b_4_handle_in_x-b_stroke/2,y:b_4_handle_in_y-b_stroke/2},bezier_control_out={x:b_3_handle_out_x-b_stroke/2,y:b_3_handle_out_y-b_stroke/2},bezier_point_1={x:b_3_node_x-b_stroke/2,y:b_3_node_y-b_stroke/2},bezier_node_1=Bezier(bezier_point_0,bezier_control_in,bezier_control_out,bezier_point_1,".2"),bezier_node_2=Bezier(bezier_point_0,bezier_control_in,bezier_control_out,bezier_point_1,".45")),t_girth=(bezier_node_2.x-bezier_node_1.x)/4,"center"==e.dataset.position&&(t_girth=10,bezier_node_2={x:b_width/2+2*t_girth-b_stroke/2,y:b_height-b_stroke/2-b_stroke/2},bezier_point_0={x:b_width/2-2*t_girth-b_stroke/2,y:b_height-b_stroke/2-b_stroke/2},bezier_control_out={x:b_4_handle_out_x-b_stroke/2-b_stroke/2,y:b_4_handle_out_y-b_stroke/2-b_stroke/2},bezier_control_in={x:b_1_handle_in_x-b_stroke/2-b_stroke/2,y:b_1_handle_in_y-b_stroke/2-b_stroke/2},bezier_point_1={x:b_width/2+2*t_girth-b_stroke/2,y:b_height-b_stroke/2-b_stroke/2},bezier_node_1=Bezier(bezier_point_0,bezier_control_out,bezier_control_in,bezier_point_1,"1"),bezier_node_2=Bezier(bezier_point_0,bezier_control_out,bezier_control_in,bezier_point_1,"0"),t_girth=(bezier_node_2.x-bezier_node_1.x)/2),"left"==t_direction&&(t_x0=bezier_node_2.x,t_y0=bezier_node_2.y,t_x1=bezier_node_1.x,t_y1=bezier_node_1.y,t_x2=bezier_node_2.x,t_y2=bezier_node_2.y+t_length/10,t_x3=bezier_node_2.x-t_girth,t_y3=bezier_node_2.y+t_length,t_x4=bezier_node_2.x,t_y4=bezier_node_2.y),"right"==t_direction&&(t_x0=bezier_node_1.x,t_y0=bezier_node_1.y,t_x1=bezier_node_2.x,t_y1=bezier_node_2.y,t_x2=bezier_node_1.x,t_y2=bezier_node_1.y+t_length/10,t_x3=bezier_node_1.x+t_girth,t_y3=bezier_node_1.y+t_length,t_x4=bezier_node_1.x,t_y4=bezier_node_1.y),t_path="M"+t_x0+","+(t_y0-1),t_path+="L"+t_x1+","+(t_y1-1),t_path+="Q"+t_x2+","+t_y2,t_path+=" "+t_x3+","+t_y3,t_path+="L"+t_x4+","+(t_y4-1),t_path+="z",b_svg=document.createElementNS(xmlns,"svg"),b_svg_path=document.createElementNS(xmlns,"path"),t_svg_path1=document.createElementNS(xmlns,"path"),t_svg_path2=document.createElementNS(xmlns,"path"),b_svg.setAttribute("viewBox","0 0 "+b_width+" "+(b_height+t_length)),b_svg.setAttribute("width",b_width),b_svg.setAttribute("height",b_height+t_length),b_svg_path.setAttribute("d",b_path),b_svg_path.setAttribute("stroke","#000"),b_svg_path.setAttribute("stroke-width",b_stroke),b_svg_path.setAttribute("stroke-linecap","round"),b_svg_path.setAttribute("stroke-linejoin","round"),b_svg_path.setAttribute("fill","#fff"),t_svg_path1.setAttribute("d",t_path),t_svg_path1.setAttribute("stroke","#000"),t_svg_path1.setAttribute("stroke-width",2*b_stroke),t_svg_path1.setAttribute("stroke-linecap","round"),t_svg_path1.setAttribute("stroke-linejoin","round"),t_svg_path1.setAttribute("fill","#000"),t_svg_path2.setAttribute("d",t_path),t_svg_path2.setAttribute("fill","#fff"),b_svg.appendChild(t_svg_path1),b_svg.appendChild(b_svg_path),b_svg.appendChild(t_svg_path2),e.appendChild(b_svg)}),comicStrip.classList.remove("is-loading"),bubblesResize()}function Bezier(e,t,_,i,o){var n={x:0,y:0},r=1-o,s=r*r,c=s*r;return n.x=e.x*c+3*t.x*s*o+3*_.x*r*o*o+i.x*o*o*o,n.y=e.y*c+3*t.y*s*o+3*_.y*r*o*o+i.y*o*o*o,n}comicStrip=document.querySelector(".comic-strip"),comicFrame=document.querySelectorAll(".comic-frame"),highContrastBtn=document.querySelector(".js-highcontrast"),rtlBtn=document.querySelector(".js-rtl"),ccBtn=document.querySelector(".js-closedcaptions"),bubbleBtn=document.querySelector(".js-bubbles"),bubbles(),window.addEventListener("resize",function(e){timeout&&window.cancelAnimationFrame(timeout),timeout=window.requestAnimationFrame(function(){bubbles()})},!1),document.querySelectorAll(".caption-sr").forEach(function(e){e.addEventListener("focus",e=>{e.target.parentNode.classList.add("is-active")}),e.addEventListener("blur",e=>{e.target.parentNode.classList.remove("is-active")})}),document.querySelectorAll(".comic-frame").forEach(function(e){e.addEventListener("click",function(t){e.lastElementChild.focus()})}),highContrastBtn.addEventListener("click",function(e){highContrastBtn.classList.contains("is-active")?(highContrastBtn.classList.remove("is-active"),highContrastBtn.setAttribute("aria-pressed","false"),comicStrip.classList.remove("is-high-contrast-mode"),comicImg=document.querySelectorAll(".comic-image img"),comicImg.forEach(function(e){srcUrl=e.dataset.src,e.setAttribute("src",srcUrl)})):(highContrastBtn.classList.add("is-active"),highContrastBtn.setAttribute("aria-pressed","true"),comicStrip.classList.add("is-high-contrast-mode"),comicImg=document.querySelectorAll(".comic-image img"),comicImg.forEach(function(e){contrastUrl=e.dataset.contrast,e.setAttribute("src",contrastUrl)})),e.preventDefault}),rtlBtn.addEventListener("click",function(){rtlBtn.classList.contains("is-active")?(rtlBtn.classList.remove("is-active"),rtlBtn.setAttribute("aria-pressed","false"),comicStrip.classList.remove("is-rtl-mode")):(rtlBtn.classList.add("is-active"),rtlBtn.setAttribute("aria-pressed","true"),comicStrip.classList.add("is-rtl-mode"))}),ccBtn.addEventListener("click",function(){ccBtn.classList.contains("is-active")?(ccBtn.classList.remove("is-active"),ccBtn.setAttribute("aria-pressed","false"),comicStrip.classList.remove("is-closed-caption-mode"),document.querySelector(".comic-strip").dataset.fontsize="100",document.querySelector(".font-sizer .text strong").innerHTML="100%",document.querySelectorAll(".comic-strip .caption-closed").forEach(function(e){e.style.fontSize="100%"}),document.querySelector(".js-closedcaptions").focus(),document.querySelector(".js-resize-up").disabled=!1,document.querySelector(".js-resize-down").disabled=!0):(ccBtn.classList.add("is-active"),ccBtn.setAttribute("aria-pressed","true"),comicStrip.classList.add("is-closed-caption-mode"),document.querySelector(".comic-strip").firstElementChild.lastElementChild.focus())}),document.querySelectorAll(".font-sizer .btn").forEach(function(e){e.addEventListener("click",function(t){currentSize=document.querySelector(".comic-strip").dataset.fontsize,e.classList.contains("js-resize-up")&&(currentSize=parseFloat(currentSize)+10),e.classList.contains("js-resize-down")&&(currentSize=parseFloat(currentSize)-10),100!=currentSize&&200!=currentSize&&(document.querySelector(".js-resize-down").disabled=!1,document.querySelector(".js-resize-up").disabled=!1),100!=currentSize?(comicStrip.classList.add("is-closed-caption-mode","is-resized"),ccBtn.classList.add("is-active"),ccBtn.setAttribute("aria-pressed","true"),document.querySelector(".comic-strip").firstElementChild.lastElementChild.focus()):(comicStrip.classList.contains("is-browserZoom")||(comicStrip.classList.remove("is-closed-caption-mode"),ccBtn.classList.remove("is-active"),ccBtn.setAttribute("aria-pressed","false")),comicStrip.classList.remove("is-resized")),100==currentSize&&(document.querySelector(".js-resize-down").disabled=!0),200==currentSize&&(document.querySelector(".js-resize-up").disabled=!0),comicStrip.dataset.fontsize=currentSize,document.querySelector(".font-sizer .text strong").innerHTML=currentSize+"%",document.querySelectorAll(".comic-strip .caption-closed").forEach(function(e){e.style.fontSize=currentSize+"%"}),t.preventDefault})}),document.querySelector(".js-colourblind").addEventListener("change",function(e){sel=e.srcElement,opt=sel.options[sel.selectedIndex],mode=opt.value,colourblindReset(),"normal"!=mode?document.querySelector(".comic-strip").classList.add("is-cb-"+mode):colourblindReset()}),bubbleBtn.addEventListener("click",function(e){bubbles(),e.preventDefault});